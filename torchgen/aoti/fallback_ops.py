# This list is based on the fallback ops from torch/_inductor/lowering.py
# If you add a new op to the list, remember to run `python torchgen/gen.py --update-aoti-c-shim`
# to update C shim files.

inductor_fallback_ops = {
    "aten._adaptive_avg_pool2d_backward",
    "aten._adaptive_avg_pool2d",
    "aten._adaptive_avg_pool3d",
    "aten._adaptive_avg_pool3d_backward",
    "aten.adaptive_max_pool2d_backward",
    "aten.adaptive_max_pool2d",
    "aten.adaptive_max_pool3d",
    "aten.adaptive_max_pool3d_backward",
    "aten.addbmm",
    "aten._addmm_activation",
    "aten.addmm.out",
    "aten.addmv",
    "aten.angle",
    "aten.avg_pool2d_backward",
    "aten.avg_pool2d",
    "aten.avg_pool3d_backward",
    "aten.avg_pool3d",
    "aten.bmm.out",
    "aten.bucketize.Tensor",
    "aten.cat",
    "aten._cdist_backward",
    "aten._cdist_forward",
    "aten.cholesky_inverse",
    "aten.cholesky_solve",
    "aten.convolution_backward",
    "aten._cudnn_rnn",
    "aten._cudnn_rnn_backward",
    "aten.convolution",
    "aten.cummax",
    "aten.cummin",
    "aten.cumprod",
    "aten.cumsum",
    "aten._efficient_attention_backward",
    "aten._efficient_attention_forward",
    "aten._efficientzerotensor",
    "aten._embedding_bag",
    "aten._embedding_bag_dense_backward",
    "aten._embedding_bag_forward_only",
    "aten._embedding_bag_per_sample_weights_backward",
    "aten.exponential",
    "aten._fft_c2c",
    "aten._fft_r2c",
    "aten._flash_attention_backward",
    "aten._flash_attention_forward",
    "aten.fractional_max_pool2d_backward",
    "aten.fractional_max_pool2d",
    "aten.fractional_max_pool3d",
    "aten.fractional_max_pool3d_backward",
    "aten._fused_moving_avg_obs_fq_helper",
    "aten._fused_moving_avg_obs_fq_helper_functional",
    "aten.gcd",
    "aten.geqrf",
    "aten.grid_sampler_2d_backward",
    "aten.histc",
    "aten.histogram.bin_ct",
    "aten._histogramdd_bin_edges",
    "aten._histogramdd_from_bin_cts",
    "aten.index_reduce",
    "aten.index.Tensor",
    "aten.kthvalue",
    "aten.logcumsumexp",
    "aten.lu_unpack",
    "aten.masked_scatter",
    "aten.masked_scatter_backward",
    "aten.max_pool2d_with_indices_backward",
    "aten.max_pool2d_with_indices",
    "aten.max_pool3d_with_indices",
    "aten.max_pool3d_with_indices_backward",
    "aten.max_unpool2d",
    "aten.max_unpool3d",
    "aten.median",
    "aten.mm.out",
    "aten.mode",
    "aten.mul.Scalar",
    "aten.nanmedian",
    "aten.nonzero",
    "aten.ormqr",
    "aten._pdist_backward",
    "aten._pdist_forward",
    "aten.pow.Scalar",
    "aten.pow.Tensor_Scalar",
    "aten.pow.Tensor_Tensor",
    "aten.rand",
    "aten.rand.generator",
    "aten.randint",
    "aten.randn",
    "aten.randn.generator",
    "aten.randperm",
    "aten.repeat_interleave.Tensor",
    "aten.replication_pad1d_backward",
    "aten.replication_pad2d_backward",
    "aten.resize_",
    "aten.resize_as_",
    "aten._scaled_dot_product_efficient_attention_backward",
    "aten._scaled_dot_product_efficient_attention",
    "aten._scaled_dot_product_flash_attention_backward",
    "aten._scaled_dot_product_flash_attention",
    "aten._scaled_dot_product_flash_attention_for_cpu_backward",
    "aten._scaled_dot_product_flash_attention_for_cpu",
    "aten._scaled_mm",
    "aten.scatter_reduce.two_out",
    "aten.scatter.src_out",
    "aten.searchsorted",
    "aten._segment_reduce_backward",
    "aten.segment_reduce",
    "aten.soft_margin_loss_backward",
    "aten.sort",
    "aten.sort.stable",
    "aten._sparse_coo_tensor_with_dims_and_tensors",
    "aten._thnn_fused_lstm_cell",
    "aten.topk",
    "aten._to_sparse",
    "aten.to_sparse",
    "aten.triangular_solve",
    "aten._trilinear",
    "aten.uniform",
    "aten.upsample_bicubic2d_backward",
    "aten.upsample_linear1d_backward",
    "aten.upsample_trilinear3d_backward",
    "aten.view_as_complex",
    "aten.view_as_real",
    "aten.view.dtype",
    "aten.zeros.names",
}
